<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">


<dom-module id="operation-step">
    <template>
        <style>
        :host {
            display: block;
            margin:0;
            height: 100%;
            @apply --paper-font-common-base;
        }

        p{
            font-size: 95%;
            margin: 8px 0
        }

        .container{
            height: 100%;
            margin: 0;
            @apply(--layout-vertical);
        }
        </style>
        
        <div class="container">
            <slot name="description">
                <template is="dom-if" if=[[_description]]>
                    <p>[[_description]]</p>
                </template>
            </slot>
            <slot></slot>
        </div>
    
    </template>

    <script>
    /**
     * `operation-step`
     * Operation step component
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class OperationStep extends Polymer.Element {
        static get is() { return 'operation-step'; }
        static get properties() {
            return {
                operation: {
                    type: Object,
                    notify: true
                },
                index: {
                    type: Number,
                    reflectToAttribute: true,
                },
                result: {
                    type: Object
                },
                loading: {
                    type: Boolean,
                    value: false,
                    notify: true,
                    reflectToAttribute: true
                },
                
                _description:{
                    type: String,
                    computed: '_getDescription(operation, index)'
                }
            };
        }
      
        static get observers(){
            return ['_resultChanged(result)', ];
        }
        
        _setResult(result){
            this.set('operation.steps.' + this.index + '.result', result);
        }
      
        _resultChanged(result){
            //console.log('step result changed', result);
            this._setResult(result);
        }
      
        ready(){
            super.ready();
            //console.log('step operation', this.operation, this.index);
        }
        
        _getDescription(operation, index){
            return this.get('operation.steps.' + this.index + '.description');
        }

    }

    window.customElements.define(OperationStep.is, OperationStep);
    </script>
</dom-module>
